node ('maven') {
    stage ('cloning source code'){
    //pulling source code from git
    git 'https://github.com/sumankumarpagadala/openmrs-core.git'
    }
    stage ('building package'){
        //packaging
        sh 'mvn clean package'
    }
    stage ('archiving artifacts'){
        //archiving artifacts
        archiveArtifacts 'webapp/target/*.war'
    }
	stage('making a build directory'){
		sh 'mkdir -p $JOB_NAME/$BUILD_NUMBER'
	}
	stage ('coying war file to build directory') {
		sh 'cp /home/jenkins/workspace/OPENMRS-BUILD-PACKAGE-PIPELINE-VCS/webapp/target/openmrs.war /home/jenkins/workspace/$JOB_NAME/$BUILD_NUMBER/openmrs.war'
	}
    stage ('logs'){
        //logs
        junit allowEmptyResults: true, testResults: 'webapp/target/surefire-reports/*.xml'
    }
}
